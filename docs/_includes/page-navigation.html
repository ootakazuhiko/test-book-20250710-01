<!-- Page Navigation -->
{% assign all_pages = site.data.navigation.introduction | concat: site.data.navigation.chapters | concat: site.data.navigation.appendices %}
{% assign current_index = -1 %}
{% assign prev_page = nil %}
{% assign next_page = nil %}

<!-- Find current page index -->
{% for item in all_pages %}
  {% if page.url == item.path %}
    {% assign current_index = forloop.index0 %}
    {% break %}
  {% endif %}
{% endfor %}

<!-- Set previous and next pages -->
{% if current_index > 0 %}
  {% assign prev_index = current_index | minus: 1 %}
  {% assign prev_page = all_pages[prev_index] %}
{% endif %}

{% assign next_index = current_index | plus: 1 %}
{% if next_index < all_pages.size %}
  {% assign next_page = all_pages[next_index] %}
{% endif %}

<nav class="page-navigation" aria-label="Page navigation">
  <div class="page-nav-container">
    {% if prev_page %}
    <div class="page-nav-item page-nav-prev">
      <a href="{{ site.baseurl }}{{ prev_page.path }}" class="nav-card">
        <div class="nav-direction">← 前へ</div>
        <div class="nav-title">{{ prev_page.title }}</div>
      </a>
    </div>
    {% else %}
    <div class="page-nav-item page-nav-prev page-nav-disabled">
      <div class="nav-card">
        <div class="nav-direction">← 前へ</div>
        <div class="nav-title">最初のページです</div>
      </div>
    </div>
    {% endif %}

    <div class="page-nav-item page-nav-home">
      <a href="{{ site.baseurl }}/" class="nav-card nav-card-home">
        <div class="nav-direction">🏠 目次</div>
        <div class="nav-title">トップページ</div>
      </a>
    </div>

    {% if next_page %}
    <div class="page-nav-item page-nav-next">
      <a href="{{ site.baseurl }}{{ next_page.path }}" class="nav-card">
        <div class="nav-direction">次へ →</div>
        <div class="nav-title">{{ next_page.title }}</div>
      </a>
    </div>
    {% else %}
    <div class="page-nav-item page-nav-next page-nav-disabled">
      <div class="nav-card">
        <div class="nav-direction">次へ →</div>
        <div class="nav-title">最後のページです</div>
      </div>
    </div>
    {% endif %}
  </div>
</nav>